# Implementation Plan: TDD Integration Test Project

This document contains a complete plan for implementing a Test-Driven Development (TDD) project with unit tests, integration tests, and end-to-end tests.

## üìÅ Project Structure

```
MySolution/
‚îú‚îÄ‚îÄ MySolution.sln
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ MyProject/                          # MVC application
‚îÇ   ‚îú‚îÄ‚îÄ MyProject.csproj
‚îÇ   ‚îú‚îÄ‚îÄ Program.cs
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HomeController.cs
‚îÇ   ‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Calculator.cs
‚îÇ   ‚îî‚îÄ‚îÄ Views/
‚îÇ       ‚îî‚îÄ‚îÄ Home/
‚îÇ           ‚îî‚îÄ‚îÄ Index.cshtml
‚îú‚îÄ‚îÄ MyProject.UnitTests/               # Unit tests
‚îÇ   ‚îú‚îÄ‚îÄ MyProject.UnitTests.csproj
‚îÇ   ‚îú‚îÄ‚îÄ HomeControllerTests.cs
‚îÇ   ‚îî‚îÄ‚îÄ CalculatorTests.cs
‚îî‚îÄ‚îÄ MyProject.IntegrationTests/        # Integration tests
    ‚îú‚îÄ‚îÄ MyProject.IntegrationTests.csproj
    ‚îú‚îÄ‚îÄ Fixtures/
    ‚îÇ   ‚îî‚îÄ‚îÄ CustomWebApplicationFactory.cs
    ‚îî‚îÄ‚îÄ HomeControllerTests.cs
```

---

## üîß Setup Commands (in order)

```bash
# 1. Create solution
dotnet new sln -n MySolution

# 2. Create MVC project
dotnet new mvc -n MyProject

# 3. Add to solution
dotnet sln add MyProject/MyProject.csproj

# 4. Create unit test project
dotnet new xunit -n MyProject.UnitTests

# 5. Add to solution
dotnet sln add MyProject.UnitTests/MyProject.UnitTests.csproj

# 6. Add reference
dotnet add MyProject.UnitTests/MyProject.UnitTests.csproj reference MyProject/MyProject.csproj

# 7. Create integration test project
dotnet new xunit -n MyProject.IntegrationTests

# 8. Add to solution
dotnet sln add MyProject.IntegrationTests/MyProject.IntegrationTests.csproj

# 9. Add reference
dotnet add MyProject.IntegrationTests/MyProject.IntegrationTests.csproj reference MyProject/MyProject.csproj

# 10. Install RestSharp
dotnet add MyProject.IntegrationTests/MyProject.IntegrationTests.csproj package RestSharp

# 11. Install Moq and Logging for unit tests
dotnet add MyProject.UnitTests package Moq
dotnet add MyProject.UnitTests package Microsoft.Extensions.Logging.Abstractions

# 12. Install Coverlet
dotnet add MyProject.UnitTests package coverlet.msbuild

# 13. Install ReportGenerator (global tool)
dotnet tool install --global dotnet-reportgenerator-globaltool

# 14. Install Microsoft.AspNetCore.Mvc.Testing
dotnet add MyProject.IntegrationTests package Microsoft.AspNetCore.Mvc.Testing
```

---

## üìÑ File Contents

### 1. `.gitignore`

```gitignore
## Ignore Visual Studio temporary files, build results, and
## files generated by popular Visual Studio add-ons.

# User-specific files
*.suo
*.user
*.userosscache
*.sln.docstates

# Build results
[Dd]ebug/
[Dd]ebugPublic/
[Rr]elease/
[Rr]eleases/
x64/
x86/
build/
bld/
[Bb]in/
[Oo]bj/

# Test Results
TestResults/
[Tt]est[Rr]esult*/
[Bb]uild[Ll]og.*

# Coverage reports
coverage/
*.coverage
*.coveragexml

# Visual Studio cache/options directory
.vs/

# JetBrains Rider
.idea/
*.sln.iml

# Mac
.DS_Store
```

---

### 2. `MyProject/Models/Calculator.cs`

```csharp
namespace MyProject.Models
{
    /// <summary>
    /// Simple calculator class for demonstration purposes
    /// </summary>
    public class Calculator
    {
        /// <summary>
        /// Adds two integers together
        /// </summary>
        /// <param name="a">First number</param>
        /// <param name="b">Second number</param>
        /// <returns>Sum of a and b</returns>
        public int Add(int a, int b)
        {
            return a + b;
        }
    }
}
```

---

### 3. `MyProject/Controllers/HomeController.cs`

```csharp
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;

namespace MyProject.Controllers
{
    public class HomeController : Controller
    {
        private readonly ILogger<HomeController> _logger;

        public HomeController(ILogger<HomeController> logger)
        {
            _logger = logger;
        }

        public IActionResult Index()
        {
            _logger.LogInformation("Index action called");
            return View();
        }

        public IActionResult Privacy()
        {
            return View();
        }

        [ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
        public IActionResult Error()
        {
            return View();
        }
    }
}
```

---

### 4. `MyProject/Program.cs`

**IMPORTANT:** The class must be `public partial` for WebApplicationFactory to work!

```csharp
var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddControllersWithViews();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Home/Error");
    app.UseHsts();
}

app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

app.UseAuthorization();

app.MapControllerRoute(
    name: "default",
    pattern: "{controller=Home}/{action=Index}/{id?}");

app.Run();

// Make Program class accessible for WebApplicationFactory
public partial class Program { }
```

---

### 5. `MyProject.UnitTests/CalculatorTests.cs`

```csharp
using Xunit;
using MyProject.Models;

namespace MyProject.UnitTests
{
    [Trait("Category", "Unit")]
    public class CalculatorTests
    {
        [Fact]
        public void Add_ShouldReturnSum_WhenGivenTwoNumbers()
        {
            // Arrange
            var calculator = new Calculator();
            
            // Act
            var result = calculator.Add(1, 2);
            
            // Assert
            Assert.Equal(3, result);
        }

        [Theory]
        [InlineData(0, 0, 0)]
        [InlineData(1, 1, 2)]
        [InlineData(-1, 1, 0)]
        [InlineData(100, 200, 300)]
        public void Add_ShouldReturnCorrectSum_ForVariousInputs(int a, int b, int expected)
        {
            // Arrange
            var calculator = new Calculator();
            
            // Act
            var result = calculator.Add(a, b);
            
            // Assert
            Assert.Equal(expected, result);
        }
    }
}
```

---

### 6. `MyProject.UnitTests/HomeControllerTests.cs`

```csharp
using Xunit;
using Microsoft.AspNetCore.Mvc;
using MyProject.Controllers;
using Microsoft.Extensions.Logging.Abstractions;

namespace MyProject.UnitTests
{
    [Trait("Category", "Unit")]
    public class HomeControllerTests
    {
        [Fact]
        public void Index_ReturnsViewResult()
        {
            // Arrange
            var logger = new NullLogger<HomeController>();
            var controller = new HomeController(logger);
            
            // Act
            var result = controller.Index();
            
            // Assert
            var viewResult = Assert.IsType<ViewResult>(result);
            Assert.Null(viewResult.ViewName); // Default view is expected
        }

        [Fact]
        public void Privacy_ReturnsViewResult()
        {
            // Arrange
            var logger = new NullLogger<HomeController>();
            var controller = new HomeController(logger);
            
            // Act
            var result = controller.Privacy();
            
            // Assert
            Assert.IsType<ViewResult>(result);
        }
    }
}
```

---

### 7. `MyProject.UnitTests/MyProject.UnitTests.csproj`

Add Coverlet configuration to PropertyGroup:

```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <IsPackable>false</IsPackable>
    <IsTestProject>true</IsTestProject>
    
    <!-- Coverlet Configuration -->
    <CollectCoverage>true</CollectCoverage>
    <CoverletOutputFormat>cobertura</CoverletOutputFormat>
    <CoverletOutput>./TestResults/</CoverletOutput>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="coverlet.msbuild" Version="6.0.2">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.Extensions.Logging.Abstractions" Version="8.0.2" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.11.1" />
    <PackageReference Include="Moq" Version="4.20.70" />
    <PackageReference Include="xunit" Version="2.9.2" />
    <PackageReference Include="xunit.runner.visualstudio" Version="2.8.2">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="coverlet.collector" Version="6.0.2">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\MyProject\MyProject.csproj" />
  </ItemGroup>

</Project>
```

---

### 8. `MyProject.IntegrationTests/Fixtures/CustomWebApplicationFactory.cs`

```csharp
using Microsoft.AspNetCore.Mvc.Testing;

namespace MyProject.IntegrationTests.Fixtures
{
    public class CustomWebApplicationFactory<TEntryPoint> : WebApplicationFactory<TEntryPoint> 
        where TEntryPoint : class
    {
        protected override void ConfigureWebHost(Microsoft.AspNetCore.Hosting.IWebHostBuilder builder)
        {
            // Configure your application for testing here if needed
            // For example: mock services, test database, etc.
            
            builder.ConfigureServices(services =>
            {
                // Add or replace services here as needed
            });
        }
    }
}
```

---

### 9. `MyProject.IntegrationTests/HomeControllerTests.cs`

```csharp
using Xunit;
using MyProject.IntegrationTests.Fixtures;
using RestSharp;
using System.Net;

namespace MyProject.IntegrationTests
{
    [Trait("Category", "Integration")]
    public class HomeControllerTests : IClassFixture<CustomWebApplicationFactory<Program>>
    {
        private readonly RestClient _client;

        public HomeControllerTests(CustomWebApplicationFactory<Program> factory)
        {
            var httpClient = factory.CreateClient();
            _client = new RestClient(httpClient);
        }

        [Fact]
        public async Task Index_ReturnsOkResponse()
        {
            // Arrange
            var request = new RestRequest("/");
            
            // Act
            var response = await _client.ExecuteAsync(request);
            
            // Assert
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
        }

        [Fact]
        public async Task Privacy_ReturnsOkResponse()
        {
            // Arrange
            var request = new RestRequest("/Home/Privacy");
            
            // Act
            var response = await _client.ExecuteAsync(request);
            
            // Assert
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
        }

        [Fact]
        public async Task Index_ReturnsHtmlContent()
        {
            // Arrange
            var request = new RestRequest("/");
            
            // Act
            var response = await _client.ExecuteAsync(request);
            
            // Assert
            Assert.Contains("text/html", response.ContentType ?? "");
        }
    }
}
```

---

### 10. `MyProject.IntegrationTests/MyProject.IntegrationTests.csproj`

```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <IsPackable>false</IsPackable>
    <IsTestProject>true</IsTestProject>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.AspNetCore.Mvc.Testing" Version="8.0.11" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.11.1" />
    <PackageReference Include="RestSharp" Version="112.1.0" />
    <PackageReference Include="xunit" Version="2.9.2" />
    <PackageReference Include="xunit.runner.visualstudio" Version="2.8.2">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="coverlet.collector" Version="6.0.2">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\MyProject\MyProject.csproj" />
  </ItemGroup>

</Project>
```

---

## üìù README.md

```markdown
# TDD Integration Test Demo Project

This project demonstrates Test-Driven Development (TDD) with unit tests and integration tests in .NET using xUnit.

## üìã Prerequisites

- [.NET 8 SDK](https://dotnet.microsoft.com/download/dotnet/8.0)
- A code editor (Visual Studio, VS Code, or Rider)

## üöÄ Getting Started

### 1. Clone or Create the Project

```bash
# If creating from scratch, follow the setup commands below
# Otherwise clone this repository
git clone <repository-url>
cd MySolution
```

### 2. Build the Project

```bash
dotnet build
```

### 3. Run the Application

```bash
cd MyProject
dotnet run
```

Visit `https://localhost:5001` in your browser (port may vary, check the logs).

## üß™ Running Tests

### Run All Tests

```bash
dotnet test
```

### Run Unit Tests Only

```bash
dotnet test --filter Category=Unit
```

### Run Integration Tests Only

```bash
dotnet test --filter Category=Integration
```

### Run Tests with Code Coverage

```bash
dotnet test /p:CollectCoverage=true
```

### Generate Code Coverage Report

```bash
# Run tests with code coverage first
dotnet test /p:CollectCoverage=true

# Generate HTML report
dotnet tool run reportgenerator \
  -reports:./MyProject.UnitTests/TestResults/coverage.cobertura.xml \
  -targetdir:./TestResults/CoverageReport \
  -reporttypes:Html

# Open report (Windows)
start ./TestResults/CoverageReport/index.html

# Open report (Mac/Linux)
open ./TestResults/CoverageReport/index.html
```

## üìÅ Project Structure

```
MySolution/
‚îú‚îÄ‚îÄ MyProject/                    # MVC application
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/              # Controllers
‚îÇ   ‚îú‚îÄ‚îÄ Models/                   # Business logic
‚îÇ   ‚îî‚îÄ‚îÄ Views/                    # Razor views
‚îú‚îÄ‚îÄ MyProject.UnitTests/          # Unit tests
‚îÇ   ‚îú‚îÄ‚îÄ CalculatorTests.cs
‚îÇ   ‚îî‚îÄ‚îÄ HomeControllerTests.cs
‚îî‚îÄ‚îÄ MyProject.IntegrationTests/   # Integration tests
    ‚îú‚îÄ‚îÄ Fixtures/
    ‚îÇ   ‚îî‚îÄ‚îÄ CustomWebApplicationFactory.cs
    ‚îî‚îÄ‚îÄ HomeControllerTests.cs
```

## üîç Test Types

### Unit Tests
- Test individual components in isolation
- Fast to execute
- Use mocking for dependencies
- Tagged with `[Trait("Category", "Unit")]`

### Integration Tests
- Test interaction between components
- Use `WebApplicationFactory` to start the application
- Test HTTP endpoints with RestSharp
- Tagged with `[Trait("Category", "Integration")]`

## üìö Technologies

- **xUnit** - Testing framework
- **Moq** - Mocking library
- **RestSharp** - HTTP client for integration tests
- **WebApplicationFactory** - In-memory test server
- **Coverlet** - Code coverage tool
- **ReportGenerator** - Generates HTML reports from code coverage

## üîó Resources

- [xUnit Documentation](https://xunit.net/docs/getting-started/netcore/cmdline)
- [Moq Quickstart](https://github.com/moq/moq4/wiki/Quickstart)
- [Testing Controllers in ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/testing)
- [Coverlet GitHub](https://github.com/coverlet-coverage/coverlet)
- [ReportGenerator GitHub](https://github.com/danielpalme/ReportGenerator)

## üìÑ License

This project is created for demonstration and educational purposes.
```

---

## ‚úÖ Verification Checklist

After implementation, verify that:

- [ ] All projects build without errors: `dotnet build`
- [ ] Application starts: `cd MyProject && dotnet run`
- [ ] All tests pass: `dotnet test`
- [ ] Unit tests can be run separately: `dotnet test --filter Category=Unit`
- [ ] Integration tests can be run separately: `dotnet test --filter Category=Integration`
- [ ] Code coverage works: `dotnet test /p:CollectCoverage=true`
- [ ] Code coverage report generates correctly
- [ ] Program.cs is `public partial class Program { }`
- [ ] RestSharp uses modern syntax: `new RestRequest("/")`
- [ ] All test classes have `[Trait("Category", "...")]`

---

## üîÑ Modern Implementation Features

1. **RestSharp API**: Updated to v112+ syntax (no `Method.Get` enum)
2. **.NET Version**: Uses .NET 8 (latest LTS)
3. **NuGet Versions**: Latest stable versions of all packages
4. **Program.cs**: Minimal hosting model with `public partial class`
5. **Theory Tests**: Added examples with `[Theory]` and `[InlineData]`

---

# üé® APPENDIX: Frontend Calculator Extension with Playwright

This section extends the base implementation with a modern React frontend calculator that can be tested with Playwright.

## Overview

This extension adds:
- **React + TypeScript** frontend with Vite
- **Calculator API** endpoint in .NET
- **Playwright E2E tests** with comprehensive test coverage
- **Accessibility-focused** UI with proper test attributes

---

## üìÅ Extended Project Structure

```
MySolution/
‚îú‚îÄ‚îÄ MyProject/                          # MVC application
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HomeController.cs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CalculatorApiController.cs  # NEW: Calculator API
‚îÇ   ‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Calculator.cs
‚îÇ   ‚îú‚îÄ‚îÄ ClientApp/                      # NEW: React frontend
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ main.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ App.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ App.css
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ index.css
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ Calculator.tsx
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Calculator.css
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ calculatorApi.ts
‚îÇ   ‚îî‚îÄ‚îÄ wwwroot/                        # Built frontend files
‚îî‚îÄ‚îÄ MyProject.PlaywrightTests/          # NEW: Playwright E2E tests
    ‚îú‚îÄ‚îÄ MyProject.PlaywrightTests.csproj
    ‚îú‚îÄ‚îÄ playwright.config.ts
    ‚îú‚îÄ‚îÄ tests/
    ‚îÇ   ‚îî‚îÄ‚îÄ calculator.spec.ts
    ‚îî‚îÄ‚îÄ package.json
```

---

## üîß Additional Setup Commands

```bash
# 15. Add Calculator API Controller (see file contents below)

# 16. Create React frontend with Vite
cd MyProject
npm create vite@latest ClientApp -- --template react-ts
cd ClientApp
npm install

# 17. Install Axios for API calls
npm install axios

# 18. Create Playwright test project
cd ../..
dotnet new xunit -n MyProject.PlaywrightTests
dotnet sln add MyProject.PlaywrightTests/MyProject.PlaywrightTests.csproj

# 19. Install Playwright in test project
cd MyProject.PlaywrightTests
npm init -y
npm install -D @playwright/test
npx playwright install

# 20. Update MyProject.csproj to build React app (see below)
```

---

## üìÑ Additional Files

### 11. `MyProject/Controllers/CalculatorApiController.cs`

```csharp
using Microsoft.AspNetCore.Mvc;
using MyProject.Models;

namespace MyProject.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class CalculatorApiController : ControllerBase
    {
        private readonly Calculator _calculator;
        private readonly ILogger<CalculatorApiController> _logger;

        public CalculatorApiController(ILogger<CalculatorApiController> logger)
        {
            _calculator = new Calculator();
            _logger = logger;
        }

        /// <summary>
        /// Adds two numbers
        /// </summary>
        [HttpPost("add")]
        [ProducesResponseType(typeof(CalculatorResult), StatusCodes.Status200OK)]
        public IActionResult Add([FromBody] CalculatorRequest request)
        {
            _logger.LogInformation("Add called with a={A}, b={B}", request.A, request.B);
            
            var result = _calculator.Add(request.A, request.B);
            
            return Ok(new CalculatorResult 
            { 
                Result = result,
                Operation = "add",
                A = request.A,
                B = request.B
            });
        }

        /// <summary>
        /// Health check endpoint
        /// </summary>
        [HttpGet("health")]
        public IActionResult Health()
        {
            return Ok(new { status = "healthy", timestamp = DateTime.UtcNow });
        }
    }

    public class CalculatorRequest
    {
        public int A { get; set; }
        public int B { get; set; }
    }

    public class CalculatorResult
    {
        public int Result { get; set; }
        public string Operation { get; set; } = string.Empty;
        public int A { get; set; }
        public int B { get; set; }
    }
}
```

---

### 12. `MyProject/ClientApp/src/components/Calculator.tsx`

```tsx
import { useState } from 'react';
import { addNumbers } from '../services/calculatorApi';
import './Calculator.css';

export function Calculator() {
  const [numberA, setNumberA] = useState<string>('');
  const [numberB, setNumberB] = useState<string>('');
  const [result, setResult] = useState<number | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleCalculate = async () => {
    setError(null);
    setLoading(true);

    try {
      const a = parseInt(numberA, 10);
      const b = parseInt(numberB, 10);

      if (isNaN(a) || isNaN(b)) {
        setError('Please enter valid numbers');
        return;
      }

      const response = await addNumbers(a, b);
      setResult(response.result);
    } catch (err) {
      setError('Failed to calculate. Please try again.');
      console.error('Calculation error:', err);
    } finally {
      setLoading(false);
    }
  };

  const handleClear = () => {
    setNumberA('');
    setNumberB('');
    setResult(null);
    setError(null);
  };

  return (
    <div className="calculator" data-testid="calculator">
      <h2 className="calculator-title">Calculator</h2>
      
      <div className="calculator-inputs">
        <div className="input-group">
          <label htmlFor="number-a">First Number:</label>
          <input
            id="number-a"
            data-testid="input-a"
            type="number"
            value={numberA}
            onChange={(e) => setNumberA(e.target.value)}
            placeholder="Enter first number"
            disabled={loading}
          />
        </div>

        <div className="input-group">
          <label htmlFor="number-b">Second Number:</label>
          <input
            id="number-b"
            data-testid="input-b"
            type="number"
            value={numberB}
            onChange={(e) => setNumberB(e.target.value)}
            placeholder="Enter second number"
            disabled={loading}
          />
        </div>
      </div>

      <div className="calculator-buttons">
        <button
          data-testid="calculate-button"
          onClick={handleCalculate}
          disabled={loading || !numberA || !numberB}
          className="btn btn-primary"
        >
          {loading ? 'Calculating...' : 'Calculate'}
        </button>
        
        <button
          data-testid="clear-button"
          onClick={handleClear}
          disabled={loading}
          className="btn btn-secondary"
        >
          Clear
        </button>
      </div>

      {error && (
        <div className="calculator-error" data-testid="error-message" role="alert">
          {error}
        </div>
      )}

      {result !== null && !error && (
        <div className="calculator-result" data-testid="result-display">
          <strong>Result:</strong> {result}
        </div>
      )}
    </div>
  );
}
```

---

### 13. `MyProject/ClientApp/src/components/Calculator.css`

```css
.calculator {
  max-width: 500px;
  margin: 2rem auto;
  padding: 2rem;
  background: #ffffff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.calculator-title {
  text-align: center;
  color: #333;
  margin-bottom: 1.5rem;
}

.calculator-inputs {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.input-group label {
  font-weight: 600;
  color: #555;
}

.input-group input {
  padding: 0.75rem;
  border: 2px solid #ddd;
  border-radius: 4px;
  font-size: 1rem;
  transition: border-color 0.3s;
}

.input-group input:focus {
  outline: none;
  border-color: #007bff;
}

.input-group input:disabled {
  background-color: #f5f5f5;
  cursor: not-allowed;
}

.calculator-buttons {
  display: flex;
  gap: 1rem;
  margin-bottom: 1rem;
}

.btn {
  flex: 1;
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.btn-primary {
  background-color: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background-color: #0056b3;
}

.btn-secondary {
  background-color: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background-color: #545b62;
}

.calculator-result {
  padding: 1rem;
  background-color: #d4edda;
  border: 1px solid #c3e6cb;
  border-radius: 4px;
  color: #155724;
  text-align: center;
  font-size: 1.25rem;
}

.calculator-error {
  padding: 1rem;
  background-color: #f8d7da;
  border: 1px solid #f5c6cb;
  border-radius: 4px;
  color: #721c24;
  text-align: center;
}
```

---

### 14. `MyProject/ClientApp/src/services/calculatorApi.ts`

```typescript
import axios from 'axios';

const API_BASE_URL = '/api/calculatorapi';

export interface CalculatorResponse {
  result: number;
  operation: string;
  a: number;
  b: number;
}

export const addNumbers = async (a: number, b: number): Promise<CalculatorResponse> => {
  const response = await axios.post<CalculatorResponse>(`${API_BASE_URL}/add`, {
    a,
    b,
  });
  return response.data;
};

export const checkHealth = async (): Promise<{ status: string; timestamp: string }> => {
  const response = await axios.get(`${API_BASE_URL}/health`);
  return response.data;
};
```

---

### 15. `MyProject/ClientApp/src/App.tsx`

```tsx
import { Calculator } from './components/Calculator';
import './App.css';

function App() {
  return (
    <div className="app">
      <header className="app-header">
        <h1>TDD Calculator Demo</h1>
        <p>A modern calculator with comprehensive testing</p>
      </header>
      
      <main className="app-main">
        <Calculator />
      </main>
      
      <footer className="app-footer">
        <p>Built with React, TypeScript, and .NET 8</p>
      </footer>
    </div>
  );
}

export default App;
```

---

### 16. `MyProject/ClientApp/src/App.css`

```css
.app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.app-header {
  text-align: center;
  padding: 2rem;
  color: white;
}

.app-header h1 {
  margin: 0;
  font-size: 2.5rem;
}

.app-header p {
  margin: 0.5rem 0 0;
  font-size: 1.1rem;
  opacity: 0.9;
}

.app-main {
  flex: 1;
  padding: 2rem;
}

.app-footer {
  text-align: center;
  padding: 1rem;
  color: white;
  opacity: 0.8;
}
```

---

### 17. `MyProject/ClientApp/src/main.tsx`

```tsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
);
```

---

### 18. `MyProject/ClientApp/src/index.css`

```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}
```

---

### 19. `MyProject/ClientApp/vite.config.ts`

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:5000',
        changeOrigin: true,
        secure: false,
      },
    },
  },
  build: {
    outDir: '../wwwroot',
    emptyOutDir: true,
  },
});
```

---

### 20. `MyProject/ClientApp/package.json`

```json
{
  "name": "calculator-client",
  "private": true,
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0"
  },
  "dependencies": {
    "axios": "^1.7.7",
    "react": "^18.3.1",
    "react-dom": "^18.3.1"
  },
  "devDependencies": {
    "@types/react": "^18.3.12",
    "@types/react-dom": "^18.3.1",
    "@typescript-eslint/eslint-plugin": "^8.15.0",
    "@typescript-eslint/parser": "^8.15.0",
    "@vitejs/plugin-react": "^4.3.4",
    "eslint": "^9.15.0",
    "eslint-plugin-react-hooks": "^5.0.0",
    "eslint-plugin-react-refresh": "^0.4.14",
    "typescript": "^5.6.3",
    "vite": "^6.0.1"
  }
}
```

---

### 21. `MyProject/ClientApp/tsconfig.json`

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

---

### 22. `MyProject/ClientApp/tsconfig.node.json`

```json
{
  "compilerOptions": {
    "composite": true,
    "skipLibCheck": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "allowSyntheticDefaultImports": true
  },
  "include": ["vite.config.ts"]
}
```

---

### 23. `MyProject/ClientApp/index.html`

```html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TDD Calculator Demo</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

---

### 24. `MyProject/MyProject.csproj` (Updated for SPA)

Add the following to build React app automatically:

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <SpaRoot>ClientApp\</SpaRoot>
  </PropertyGroup>

  <ItemGroup>
    <!-- Don't publish the SPA source files, but do show them in the project files list -->
    <Content Remove="$(SpaRoot)**" />
    <None Remove="$(SpaRoot)**" />
    <None Include="$(SpaRoot)**" Exclude="$(SpaRoot)node_modules\**" />
  </ItemGroup>

  <Target Name="BuildClientApp" BeforeTargets="Build" Condition="'$(Configuration)' == 'Release'">
    <Exec WorkingDirectory="$(SpaRoot)" Command="npm install" />
    <Exec WorkingDirectory="$(SpaRoot)" Command="npm run build" />
  </Target>

</Project>
```

---

## üé≠ Playwright E2E Tests

### 25. `MyProject.PlaywrightTests/tests/calculator.spec.ts`

```typescript
import { test, expect } from '@playwright/test';

test.describe('Calculator E2E Tests', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('http://localhost:5000');
    await page.waitForSelector('[data-testid="calculator"]');
  });

  test('should display calculator component', async ({ page }) => {
    const calculator = page.locator('[data-testid="calculator"]');
    await expect(calculator).toBeVisible();
    await expect(page.locator('h2.calculator-title')).toHaveText('Calculator');
  });

  test('should have all required input fields and buttons', async ({ page }) => {
    await expect(page.locator('[data-testid="input-a"]')).toBeVisible();
    await expect(page.locator('[data-testid="input-b"]')).toBeVisible();
    await expect(page.locator('[data-testid="calculate-button"]')).toBeVisible();
    await expect(page.locator('[data-testid="clear-button"]')).toBeVisible();
  });

  test('should calculate sum of two numbers', async ({ page }) => {
    await page.locator('[data-testid="input-a"]').fill('5');
    await page.locator('[data-testid="input-b"]').fill('3');
    await page.locator('[data-testid="calculate-button"]').click();
    
    await page.waitForSelector('[data-testid="result-display"]');
    const result = page.locator('[data-testid="result-display"]');
    await expect(result).toContainText('Result: 8');
  });

  test('should handle negative numbers', async ({ page }) => {
    await page.locator('[data-testid="input-a"]').fill('-10');
    await page.locator('[data-testid="input-b"]').fill('5');
    await page.locator('[data-testid="calculate-button"]').click();
    
    await page.waitForSelector('[data-testid="result-display"]');
    const result = page.locator('[data-testid="result-display"]');
    await expect(result).toContainText('Result: -5');
  });

  test('should handle zero values', async ({ page }) => {
    await page.locator('[data-testid="input-a"]').fill('0');
    await page.locator('[data-testid="input-b"]').fill('0');
    await page.locator('[data-testid="calculate-button"]').click();
    
    await page.waitForSelector('[data-testid="result-display"]');
    const result = page.locator('[data-testid="result-display"]');
    await expect(result).toContainText('Result: 0');
  });

  test('should clear inputs and result', async ({ page }) => {
    await page.locator('[data-testid="input-a"]').fill('10');
    await page.locator('[data-testid="input-b"]').fill('20');
    await page.locator('[data-testid="calculate-button"]').click();
    await page.waitForSelector('[data-testid="result-display"]');
    
    await page.locator('[data-testid="clear-button"]').click();
    
    await expect(page.locator('[data-testid="input-a"]')).toHaveValue('');
    await expect(page.locator('[data-testid="input-b"]')).toHaveValue('');
    await expect(page.locator('[data-testid="result-display"]')).not.toBeVisible();
  });

  test('should disable calculate button when inputs are empty', async ({ page }) => {
    const calculateButton = page.locator('[data-testid="calculate-button"]');
    await expect(calculateButton).toBeDisabled();
    
    await page.locator('[data-testid="input-a"]').fill('5');
    await expect(calculateButton).toBeDisabled();
    
    await page.locator('[data-testid="input-b"]').fill('3');
    await expect(calculateButton).toBeEnabled();
  });

  test('should handle large numbers', async ({ page }) => {
    await page.locator('[data-testid="input-a"]').fill('999999');
    await page.locator('[data-testid="input-b"]').fill('1');
    await page.locator('[data-testid="calculate-button"]').click();
    
    await page.waitForSelector('[data-testid="result-display"]');
    const result = page.locator('[data-testid="result-display"]');
    await expect(result).toContainText('Result: 1000000');
  });

  test('should maintain accessibility attributes', async ({ page }) => {
    await expect(page.locator('label[for="number-a"]')).toBeVisible();
    await expect(page.locator('label[for="number-b"]')).toBeVisible();
  });
});

test.describe('Calculator API Integration', () => {
  test('should successfully communicate with backend API', async ({ page }) => {
    const apiPromise = page.waitForResponse(
      response => response.url().includes('/api/calculatorapi/add') && response.status() === 200
    );
    
    await page.goto('http://localhost:5000');
    await page.locator('[data-testid="input-a"]').fill('7');
    await page.locator('[data-testid="input-b"]').fill('3');
    await page.locator('[data-testid="calculate-button"]').click();
    
    const response = await apiPromise;
    const responseBody = await response.json();
    
    expect(responseBody).toHaveProperty('result', 10);
    expect(responseBody).toHaveProperty('operation', 'add');
    expect(responseBody).toHaveProperty('a', 7);
    expect(responseBody).toHaveProperty('b', 3);
  });
});
```

---

### 26. `MyProject.PlaywrightTests/playwright.config.ts`

```typescript
import { defineConfig, devices } from '@playwright/test';

export default defineConfig({
  testDir: './tests',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: 'html',
  
  use: {
    baseURL: 'http://localhost:5000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
  },

  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] },
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] },
    },
  ],

  webServer: {
    command: 'dotnet run --project ../MyProject/MyProject.csproj',
    url: 'http://localhost:5000',
    reuseExistingServer: !process.env.CI,
    timeout: 120000,
  },
});
```

---

### 27. `MyProject.PlaywrightTests/package.json`

```json
{
  "name": "playwright-tests",
  "version": "1.0.0",
  "description": "Playwright E2E tests for Calculator",
  "scripts": {
    "test": "playwright test",
    "test:headed": "playwright test --headed",
    "test:ui": "playwright test --ui",
    "test:debug": "playwright test --debug",
    "report": "playwright show-report"
  },
  "devDependencies": {
    "@playwright/test": "^1.48.2",
    "@types/node": "^22.9.3"
  }
}
```

---

## üß™ Running Frontend and E2E Tests

### Development Mode

```bash
# Terminal 1: Start backend
cd MyProject
dotnet run

# Terminal 2: Start frontend in dev mode
cd MyProject/ClientApp
npm run dev

# Terminal 3: Run Playwright tests
cd MyProject.PlaywrightTests
npm test
```

### Production Mode

```bash
# Build frontend
cd MyProject/ClientApp
npm run build

# Start application (serves built files from wwwroot)
cd ..
dotnet run

# Run Playwright tests
cd ../MyProject.PlaywrightTests
npm test
```

### Playwright Test Commands

```bash
# Run all tests
npm test

# Run tests with UI
npm run test:ui

# Run tests in headed mode (see browser)
npm run test:headed

# Debug mode
npm run test:debug

# Show latest report
npm run report

# Run specific test
npx playwright test calculator.spec.ts

# Run tests in specific browser
npx playwright test --project=chromium
npx playwright test --project=firefox
npx playwright test --project=webkit
```

---

## üìã Extended Verification Checklist

- [ ] Backend API works: `curl http://localhost:5000/api/calculatorapi/health`
- [ ] Frontend builds: `cd MyProject/ClientApp && npm run build`
- [ ] Frontend starts in dev mode: `npm run dev`
- [ ] Application serves frontend: `dotnet run` and visit `http://localhost:5000`
- [ ] Playwright tests installed: `cd MyProject.PlaywrightTests && npx playwright install`
- [ ] All Playwright tests pass: `npm test`
- [ ] Calculator UI is accessible and has proper test attributes
- [ ] API integration works correctly
- [ ] Tests run in all browsers (chromium, firefox, webkit)

---

## üéØ Key Features

### Test Attributes (data-testid)
All interactive elements have `data-testid` attributes for reliable testing:
- `calculator` - Main container
- `input-a` - First number input
- `input-b` - Second number input
- `calculate-button` - Calculate button
- `clear-button` - Clear button
- `result-display` - Result display
- `error-message` - Error message

### Accessibility
- Proper `<label>` elements with `for` attributes
- ARIA `role="alert"` on error messages
- Semantic HTML structure
- Keyboard navigation support

### API Integration
- RESTful API endpoint at `/api/calculatorapi/add`
- Health check endpoint at `/api/calculatorapi/health`
- Proper error handling
- Type-safe TypeScript interfaces

---

## üìö Frontend Technologies

- **React 18.3.1** - UI library
- **TypeScript 5.6.3** - Type safety
- **Vite 6.0.1** - Build tool and dev server
- **Axios 1.7.7** - HTTP client
- **Playwright 1.48.2** - E2E testing framework

---

## üîó Additional Resources

- [React Documentation](https://react.dev/)
- [Vite Documentation](https://vitejs.dev/)
- [Playwright Documentation](https://playwright.dev/)
- [Axios Documentation](https://axios-http.com/)
- [TypeScript Documentation](https://www.typescriptlang.org/)